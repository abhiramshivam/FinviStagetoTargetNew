MERGE INTO COM_FINVI_OASIS_ACCOUNT_{PP_TenantName}.CUSTOMERCONTACTADDRESS PT USING ( 	SELECT ADDRESSID, ADDRESS2, LISTAGG(final_col, ' ') WITHIN GROUP (ORDER BY row_num) ADDRESS2_PARSED 	FROM ( 	SELECT row_num, ADDRESSID, ADDRESS2, nvl(alm.code,st.column_value) AS FINAL_col 	FROM ( 		SELECT  rownum AS row_num, ADDRESSID, ADDRESS2, 			lower(column_value) AS column_value 		FROM COM_FINVI_OASIS_ACCOUNT_{PP_TenantName}.CUSTOMERCONTACTADDRESS 		, 		XMLTABLE( 		     '/values/value' 		     PASSING XMLTYPE('<values><value>' || REPLACE(REPLACE(REPLACE(ADDRESS2,',',' '), '&', 'and'), ' ', '</value><value>') || '</value></values>') 		     COLUMNS column_value VARCHAR2(100) PATH '.') 		    WHERE ADDRESS2 IS NOT NULL 		  ) ST 	LEFT JOIN COM_FINVI_OASIS_ACCOUNT_{PP_TenantName}.ADDRESSLINECODEMAPPING ALM 	ON ST.column_value = alm."TYPE" 	) 	GROUP BY ADDRESSID, ADDRESS2 ) TMP ON (PT.ADDRESSID = TMP.ADDRESSID) WHEN MATCHED THEN UPDATE SET PT.ADDRESSLINE2PARSED = TMP.ADDRESS2_PARSED