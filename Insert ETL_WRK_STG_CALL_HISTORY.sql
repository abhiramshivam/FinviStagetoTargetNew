
INSERT INTO ETL_OASIS_DATA_MIG_{PP_TenantName}.ETL_WRK_STG_CALL_HISTORY 
(
ACCOUNT_ID 			,
CONSUMER_ID 		,
NOTES 				,
NOTES_TYPE 			,
CALLMETHOD 			,
CALLOUTCOME 		,
SPOKETOOPTION 		,
IS_OVERDUE 			,
PHONENUMBER 		,
AGENTACTIONCODE 	,
ATTEMPT_DATE 		,
BALANCE 			,
CALLSECONDS 		,
CAMPAIGNNUMBER 		,
DEBTORNAME 			,
DEBTORNAME2 		,
STATUS 				,
AGENTACTIONDESCRIPTION,
PHONETYPE 			,
ADDR_LINE1 			,
ADDR_LINE2 			,
AGENT_CALL_TIME 	,
AGENT_USER_ID 		,
CALL_DATE_INITIATION,
CALL_DISCONNECT_DATE,
CALL_DISCONNECT_TIME,
CALL_ID 			,
CALL_TIME_INITIATION,
CITY 				,
CLIENT_REF_NUM 		,
EMAIL_ADDR 			,
ETL_LOAD_TS 		,
FILE_NUMBER 		,
PH_NUM2 			,
PH_NUM3 			,
PH_NUM4 			,
PH_TYPE2			,
PH_TYPE3			,
PH_TYPE4			,
RAW_RESULT_CODE 	,
RESULT_CODE 		,
STATE 				,
ZIP 				,
NOTESID 			,
CALLWRAPUPID 		,
CALLWRAPUP_ACC_ID 	)	

SELECT 
 A.ACCOUNTNUM ACCOUNT_ID 			,
C.CUSTOMERID CONSUMER_ID 		,
NOTES 				,
NOTES_TYPE 			,
CALLMETHOD 			,
CALLOUTCOME 		,
SPOKETOOPTION 		,
IS_OVERDUE 			,
PHONENUMBER 		,
AGENTACTIONCODE 	,
ATTEMPT_DATE 		,
CH.BALANCE 			,
CALLSECONDS 		,
CAMPAIGNNUMBER 		,
DEBTORNAME 			,
DEBTORNAME2 		,
STATUS 				,
AGENTACTIONDESCRIPTION,
PHONETYPE 			,
ADDR_LINE1 			,
ADDR_LINE2 			,
AGENT_CALL_TIME 	,
AGENT_USER_ID 		,
CALL_DATE_INITIATION,
CALL_DISCONNECT_DATE,
CALL_DISCONNECT_TIME,
CALL_ID 			,
CALL_TIME_INITIATION,
CITY 				,
CLIENT_REF_NUM 		,
EMAIL_ADDR 			,
ETL_LOAD_TS 		,
FILE_NUMBER 		,
PH_NUM2 			,
PH_NUM3 			,
PH_NUM4 			,
PH_TYPE2			,
PH_TYPE3			,
PH_TYPE4			,
RAW_RESULT_CODE 	,
RESULT_CODE 		,
STATE 				,
ZIP 				,
SYS_GUID() NOTESID 	,
SYS_GUID() CALLWRAPUPID ,
SYS_GUID() CALLWRAPUP_ACC_ID 	
FROM  ETL_OASIS_DATA_MIG_{PP_TenantName}.ETL_STG_CALL_HISTORY CH
JOIN COM_FINVI_OASIS_ACCOUNT_{PP_TenantName}.CUSTOMER C ON CH.CONSUMER_ID = C.MIGRATION_SOURCE_ID
JOIN COM_FINVI_OASIS_ACCOUNT_{PP_TenantName}.ACCOUNT A ON CH.ACCOUNT_ID = A.MIGRATION_SOURCE_ID 
