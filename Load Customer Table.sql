INSERT INTO COM_FINVI_OASIS_ACCOUNT_{PP_TenantName}.CUSTOMER ( 	UUID, 	CREATEDATE, 	LASTUPDATEDATE, 	CREATED_BY, 	MODIFIED_BY, 	MIGRATION_SOURCE_ID ,	 	DATEOFBIRTH, 	ISDECEASED, 	DRIVERLICENSE, 	FIRSTNAME, 	PARSEDFIRSTNAME ,	     MIDDLENAME, 	LASTNAME,	 	PARSEDLASTNAME ,	 	CUSTOMERNAME, 	GENDER , 	ISINCARCERATED, 	SSN, 	SSNHASH,	 	LAST4SSN, 	HASALIAS, 	ISLITIGIOUS, 	ISMINOR, 	LAST_SCRUB_DATE, 	LAST_SKIPTRACE_DATE ) SELECT  	SYS_GUID() AS UUID, 	SYSDATE AS CREATEDATE, 	SYSDATE AS LASTUPDATEDATE,     (SELECT IDPUSERID FROM COM_FINVI_OASIS_ACCOUNT_{PP_TenantName}.user_ WHERE USERNAME = 'etlmigrationuser@finvi.com') AS CREATED_BY,     (SELECT IDPUSERID FROM COM_FINVI_OASIS_ACCOUNT_{PP_TenantName}.user_ WHERE USERNAME = 'etlmigrationuser@finvi.com') AS MODIFIED_BY, 	pi.CONSUMERID AS MIGRATION_SOURCE_ID, 	pi.ARENBTHDTE + 0.5 AS DATEOFBIRTH, 	CASE WHEN pi.ARENDECEASED = 'Y' THEN 1 ELSE 0 END AS ISDECEASED, 	pi.ARENDRVLIC AS DRIVERLICENSE, 	pi.ARENFNM AS FIRSTNAME, 	LOWER(pi.ARENFNM) AS PARSEDFIRSTNAME,     pi.ARENMNM AS MIDDLENAME, 	pi.ARENLNM AS LASTNAME, 	LOWER(pi.ARENLNM) AS PARSEDLASTNAME, 	TRIM(pi.ARENFNM || ' ' || pi.ARENLNM) AS CUSTOMERNAME,			 	pi.ARENGENDER AS GENDER, 	CASE WHEN pi.ARENPRISFLAG = 'Y' THEN 1 ELSE 0 END AS ISINCARCERATED, 	pi.ARENSSN AS SSN, 	pi.ARENSSN AS SSNHASH,		 	SUBSTR(pi.ARENSSN,-4) AS LAST4SSN, 	CASE WHEN pa.CONSUMERID IS NULL THEN 0 ELSE 1 END AS HASALIAS, 	CASE WHEN pi.ARENLITFILEDATE IS NULL THEN 0 ELSE 1 END AS ISLITIGIOUS, 	CASE WHEN (sysdate - pi.ARENBTHDTE)/365 < 18 THEN 1 ELSE 0 END AS ISMINOR, 	ai.LASTSCRUBDTE + 0.5 AS LAST_SCRUB_DATE, 	ai.LASTSKIPDTE + 0.5 AS LAST_SKIPTRACE_DATE FROM  	ETL_OASIS_DATA_MIG_{PP_TenantName}.ETL_STG_PARTY_INFO pi 	INNER JOIN ETL_OASIS_DATA_MIG_{PP_TenantName}.ETL_STG_ACCOUNT_INFO ai ON pi.ACCOUNTID = ai.ACCOUNTID  	LEFT OUTER JOIN (SELECT DISTINCT CONSUMERID FROM ETL_OASIS_DATA_MIG_{PP_TenantName}.ETL_STG_PRTY_ALIASES) pa ON pa.CONSUMERID = pi.CONSUMERID