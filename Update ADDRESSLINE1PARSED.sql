MERGE INTO COM_FINVI_OASIS_ACCOUNT_{PP_TenantName}.CUSTOMERCONTACTADDRESS PT USING (     SELECT ADDRESSID, ADDRESS1, LISTAGG(final_col, ' ') WITHIN GROUP (ORDER BY row_num) ADDRESS1_PARSED 	FROM ( 	SELECT row_num, ADDRESSID, ADDRESS1, nvl(alm.code,st.column_value) AS FINAL_col 	FROM ( 		SELECT  rownum AS row_num, ADDRESSID, ADDRESS1, 			lower(column_value) AS column_value 		FROM COM_FINVI_OASIS_ACCOUNT_{PP_TenantName}.CUSTOMERCONTACTADDRESS 		, 		XMLTABLE( 		     '/values/value' 		     PASSING XMLTYPE('<values><value>' || REPLACE(REPLACE(REPLACE(ADDRESS1,',',' '), '&', 'and'), ' ', '</value><value>') || '</value></values>') 		     COLUMNS column_value VARCHAR2(100) PATH '.') 		 WHERE ADDRESS1 IS NOT NULL 		  ) ST 	LEFT JOIN COM_FINVI_OASIS_ACCOUNT_{PP_TenantName}.ADDRESSLINECODEMAPPING ALM 	ON ST.column_value = alm."TYPE" 	) 	GROUP BY ADDRESSID, ADDRESS1 ) TMP ON (PT.ADDRESSID = TMP.ADDRESSID) WHEN MATCHED THEN UPDATE SET PT.ADDRESSLINE1PARSED = TMP.ADDRESS1_PARSED